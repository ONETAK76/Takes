<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="https://service-online.su/text/text-editor/ckeditor5-custom/styles.css">
<style>body { font-family: Arial,Helvetica Neue,sans-serif; }</style>
</head>
<body class="ck-content"><p>&lt;!DOCTYPE html&gt;<br>&lt;html lang="ru"&gt;<br>&lt;head&gt;<br>&lt;meta charset="utf-8"&gt;<br>&lt;meta name="viewport" content="width=device-width,initial-scale=1"&gt;<br>&lt;title&gt;Zork-Like Builder&lt;/title&gt;<br>&lt;style&gt;<br>body{font-family:system-ui;background:#111;color:#0f0;margin:0;padding:8px}<br>#out{white-space:pre-wrap;height:45vh;overflow-y:scroll;border:1px solid #0f0;padding:4px}<br>#in{width:100%;font-size:18px;background:#000;color:#0f0;border:1px solid #0f0;padding:4px}<br>button{background:#000;color:#0f0;border:1px solid #0f0;padding:6px;margin:2px}<br>&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;div id="out"&gt;Добро пожаловать в Zork!&lt;br&gt;Чтобы посмотреться — наберите &lt;b&gt;look&lt;/b&gt;&lt;/div&gt;<br>&lt;input id="in" placeholder="&gt; команда" autofocus&gt;<br>&lt;br&gt;<br>&lt;button onclick="send()"&gt;↵&lt;/button&gt;<br>&lt;button onclick="exportWorld()"&gt;Экспорт&lt;/button&gt;<br>&lt;button onclick="importWorld()"&gt;Импорт&lt;/button&gt;<br>&lt;button onclick="toggleEdit()"&gt;Редактор&lt;/button&gt;</p><p>&lt;div id="edit" style="display:none"&gt;<br>&nbsp;&lt;hr&gt;<br>&nbsp;&lt;b&gt;Быстрое редактирование&lt;/b&gt;&lt;br&gt;<br>&nbsp;&lt;input id="rname" placeholder="Название комнаты"&gt;<br>&nbsp;&lt;textarea id="rdesc" placeholder="Описание" rows="3" style="width:100%"&gt;&lt;/textarea&gt;<br>&nbsp;&lt;button onclick="quickRoom()"&gt;Создать / обновить ТЕКУЩУЮ&lt;/button&gt;<br>&lt;/div&gt;</p><p>&lt;script&gt;<br>// ---------- ядро ----------<br>const world = JSON.parse(localStorage.getItem('zworld')||`{<br>&nbsp;"rooms":{"двор":{"name":"Заброшенный двор","desc":"Вы на дворе. Дверь на север.","exits":{"север":"чулан"},"items":[]},<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "чулан":{"name":"Тёмный чулан","desc":"Пахнет плесенью.","exits":{"юг":"двор"},"items":["факел"]}},<br>&nbsp;"items":{"факел":{"name":"факел","desc":"Деревянный факел."}},<br>&nbsp;"triggers":[{"cond":"has факел","act":"msg Свет теплеет;create exit вверх победа;flag факел_взят"}],<br>&nbsp;"flags":[],<br>&nbsp;"start":"двор",<br>&nbsp;"playerRoom":"двор",<br>&nbsp;"inv":[]}`);</p><p>function save(){localStorage.setItem('zworld',JSON.stringify(world))}<br>function out(s){document.getElementById('out').innerHTML+=`&lt;br&gt;${s}`}<br>function send(){<br>&nbsp;const cmd=document.getElementById('in').value.trim().toLowerCase();<br>&nbsp;if(!cmd)return;<br>&nbsp;out(`&gt; ${cmd}`);<br>&nbsp;document.getElementById('in').value='';<br>&nbsp;parse(cmd);<br>&nbsp;save();<br>}<br>function parse(cmd){<br>&nbsp;const [a,...b]=cmd.split(' '); const arg=b.join(' ');<br>&nbsp;switch(a){<br>&nbsp; &nbsp;case 'look':look();break;<br>&nbsp; &nbsp;case 'go':go(arg);break;<br>&nbsp; &nbsp;case 'take':take(arg);break;<br>&nbsp; &nbsp;case 'inv':case 'inventory':inv();break;<br>&nbsp; &nbsp;case 'use':use(arg);break;<br>&nbsp; &nbsp;default:out('Не понял: look, go, take, inv, use');<br>&nbsp;}<br>}<br>function look(){<br>&nbsp;const r=world.rooms[world.playerRoom];<br>&nbsp;out(`&lt;b&gt;${r.name}&lt;/b&gt;&lt;br&gt;${r.desc}`);<br>&nbsp;if(r.items.length)out('Здесь: '+r.items.map(i=&gt;world.items[i].name).join(', '));<br>&nbsp;if(Object.keys(r.exits).length)out('Выходы: '+Object.keys(r.exits).join(', '));<br>&nbsp;checkTriggers();<br>}<br>function go(dir){<br>&nbsp;const r=world.rooms[world.playerRoom];<br>&nbsp;if(r.exits[dir]){world.playerRoom=r.exits[dir];look();}<br>&nbsp;else out('Туда нельзя.');<br>}<br>function take(name){<br>&nbsp;const r=world.rooms[world.playerRoom];<br>&nbsp;const it=r.items.find(i=&gt;world.items[i].name.toLowerCase()===name);<br>&nbsp;if(it){r.items=r.items.filter(x=&gt;x!==it); world.inv.push(it); out('Взяли '+world.items[it].name);}<br>&nbsp;else out('Нет такого.');<br>}<br>function inv(){if(world.inv.length)out('У вас: '+world.inv.map(i=&gt;world.items[i].name).join(', '));else out('Пусто.');}<br>function use(name){if(!world.inv.find(i=&gt;world.items[i].name.toLowerCase()===name)){out('Нет.');return;}checkTriggers();}<br>function checkTriggers(){<br>&nbsp;world.triggers.forEach(t=&gt;{<br>&nbsp; &nbsp;if(evalCond(t.cond)) t.act.split(';').forEach(act=&gt;runAct(act.trim()));<br>&nbsp;});<br>}<br>function evalCond(c){<br>&nbsp;return c.split('and').every(p=&gt;{<br>&nbsp; &nbsp;if(p.trim().startsWith('has'))return world.inv.includes(p.trim().slice(4).trim());<br>&nbsp; &nbsp;if(p.trim().startsWith('in'))return world.playerRoom===p.trim().slice(3).trim();<br>&nbsp; &nbsp;if(p.trim().startsWith('flag'))return world.flags.includes(p.trim().slice(5).trim());<br>&nbsp; &nbsp;return true;<br>&nbsp;});<br>}<br>function runAct(a){<br>&nbsp;if(a.startsWith('msg'))out(a.slice(4));<br>&nbsp;if(a.startsWith('flag'))world.flags.push(a.slice(5));<br>&nbsp;if(a.startsWith('create exit')){<br>&nbsp; &nbsp;const [,dir,targ]=a.split(' '); world.rooms[world.playerRoom].exits[dir]=targ;<br>&nbsp;}<br>}<br>// ---------- редактор ----------<br>function toggleEdit(){const d=document.getElementById('edit');d.style.display=d.style.display==='none'?'block':'none';}<br>function quickRoom(){<br>&nbsp;const name=document.getElementById('rname').value.trim();<br>&nbsp;const desc=document.getElementById('rdesc').value.trim();<br>&nbsp;if(!name){alert('Введите название');return;}<br>&nbsp;const rid=world.playerRoom;<br>&nbsp;world.rooms[rid].name=name;<br>&nbsp;world.rooms[rid].desc=desc;<br>&nbsp;save(); out(`Комната «${name}» обновлена.`);<br>}<br>// ---------- экспорт / импорт ----------<br>function exportWorld(){prompt('Сохраните этот JSON:',JSON.stringify(world));}<br>function importWorld(){<br>&nbsp;const j=prompt('Вставьте JSON:');<br>&nbsp;if(!j)return;<br>&nbsp;try{Object.assign(world,JSON.parse(j));save();location.reload();}catch(e){alert('Ошибка');}<br>}<br>// ---------- старт ----------<br>look();<br>document.getElementById('in').addEventListener('keydown',e=&gt;{if(e.key==='Enter')send()});<br>&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</p>
</body>
</html>